# 基础

## HTTP 诞生

HTTP 译为 "超文本传输协议"，诞生于 1989 年 3 月。是一位名叫蒂姆伯纳斯-李这位哥儿们提出的，最初设想的基本理念是：借助多文档之间相互关联形成的超文本，连成可相互参阅的 W W W（World Wide Web，万维网）。 W W W 简称 Web。

HTTP 0.9 在 1990 年问世。那时的 HTTP 还没有作为正式的标准被建立。

HTTP 1.0 在 1996 年 5 月正式作为标准。现在该协议标准直到现在还被广泛使用在服务器端。

HTTP 1.1 在 1997 年 1 月公布为目前主流的 HTTP 协议版本。

## TCP/IP

一般使用的网络（包括互联网）是在 TCP/IP 协议的基础上运作的。HTTP 属于它内部的一个子集。

计算机和网络设备要互相通信，双方都必须基于相同的方法。例如，如何探测到通信目标、是哪一边先发起通信、使用哪种语言进行通信、怎么样结束通信等规则都是需要先确定的。不同的硬件、操作系统之间的通信，所有的这一切都需要一种规则。而这种规则称为协议。

协议中包括：从电缆的规格到 IP 地址的选定方法、寻找异地用户的方法、双方建立通信的顺序，以及 Web 页面显示需要处理的步骤，等等。把这些相关联的协议集合起来总称为 TCP/IP。

TCP/IP 重要的点就是分层。有以下 4 层：应用层、传输层、网络层和数据链路层。

### TCP/IP 各层作用

#### 应用层

应用层决定了向用户提供应用服务是通信的活动。比如，FTP 文件传输协议和 DNS。HTTP 协议也在该层。

#### 传输层

传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。该层有两个不同的协议：TCP 传输控制协议和 UDP 用户数据报协议。

#### 网络层

网络层用来处理在网络上流动的数据包。

#### 数据链路层

用来处理连接网络的硬件部分。

TCP/IP 层次化的好处是：如果互联网由一个协议统一规划，某个地方需要改变设计时，就必须把所有部分整体替换掉。而分层只需要把变动的层替换掉。把各层之间的接口部分规划好之后，每个层次内部的设计就能够自由改动。层次化之后，处于应用层的应用可以只考虑分派给自己的任务，不需要其他问题。

### TCP/IP 通信传输流

TCP/ IP 协议进行通信时，会通过分层顺序和对方进行通信。客户端从应用层往下走，接收端则从链路层往上走。举个例子：

1. 首先客户端在应用层发出一个想看某个 Web 页面的 HTTP 请求。
2. 接着，在传输层把应用层接收到的数据进行分割，在每个报文上打上标记好以及端口号后转发给网络层。
3. 在网络层，将 MAC 地址转发给链路层。
4. 接收端的服务器在链路层接收到数据后，按次序往上层发送，直到应用层。传输到应用层才算真正接收到客户端发过来的 HTTP 请求。

看下图展示整过过程。
![](./images/1/1.3.1.jpg)

客户端在每层传输数据的时候，每经过一层就会打上一个该层的首部信息。而接收层在每层传输数据的时候，每经过一层都会把对应的首部去除。

## IP、TCP 和 DNS

IP、TCP 和 DNS 这三个协议，都是和 HTTP 密不可分的。

### IP 网络协议

IP 协议的作用是把各种数据包传送给对方，它处于应用层。注意，IP 和 IP 地址别搞混。IP 是一种协议的名称。要保证确实传送到对方那里，则需要满足各类条件。
其中两个重要的条件是 IP 地址和 MAC 地址。

IP 地址指的是节点被分配到的地址，MAC 地址指的是所属的固定地址。IP 地址可以和 MAC 地址进行配对。IP 地址是可变的，MAC 地址是不可变的。

### ARP 协议

IP 间的通信依赖 MAC 地址。在网络上通信的双方在同一局域网内的情况很少，一般都是经过多台计算机或者网络设备中转才能连接到对方。而在中转时，会利用
下一站中转设备的 MAC 地址进行搜索下一个中转目标。而这时，会采用 ARP 协议。ARP 协议是一种用来解析的地址的协议，通过通信方的 IP 地址就能反查出
对应的 MAC 地址。

在到达通信目标前的中转过程中，计算机和路由器只能获悉很粗略的传输路线。这种机制叫做路由选择。

### 可靠性的 TCP 协议

TCP 位于传输层，提供可靠性的字节流服务。字节流服务指的是，为了方便传输，将大块数据分割以报文段为单位的数据包进行管理。而可靠性的传输服务指的是，能
把数据准确可靠地传给对方。

为了准确地把数据传送给对方，这时 TCP 协议的三次握手就出现了。

- 第一次握手：发送端先发送一个带 SYN 标志的数据包给对方。
- 第二次握手：接收端收到之后，回传一个带有 SYN/ACK 标志的数据包表示传达确认信息。
- 第三次握手：最后，发送端再传回一个带 ACK 标志的数据包，表示 “握手” 结束。

下图展示这个过程。

![](./images/1/1.4.1.jpg)

### DNS 服务

DNS 服务是和 HTTP 协议一样，位于应用层。计算机既可以被赋予 IP 地址，也可以被赋予主机名和**域名**。例如，www.tutu.com。而 DNS 协议提供了通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。
![](./images/1/1-5-1.jpg)

下图展示每个协议跟 HTTP 协议的关系。
![](./images/1/1-6-1.jpg)

## URI 和 URL

### 什么是 URI

**URL** 是访问 Web 页面需要输入的网站地址。例如，`http://www.tutu.com/`就是 **URL**。

**URI** 是统一资源标识符。全称叫 `Uniform Resource Locator`。 它的作用是区分互联网上不同的资源，而 **URL** 表示资源的地点。URL 是 URI 的子集。

### URI 格式

`http://user:pass@www.tutu.com:8080/html/index.html?userId=1#cn1`

- **协议名**：`http:`或`https:`表示协议名称。不区分字母大小写，最后要加上`://`。
- **登录信息**：**user:pass@** 表示获取服务器资源的用户名和密码。不推荐使用，不安全，也没用过。
- **服务器地址**：服务器地址可以是三种：
  - 以域名的形式`www.tutu.com`；
  - 以 IPv4 `192.168.0.1`地址名；
  - 以`[0:0:0:0:0:0:1]`这种方括号括起来 IPv6 地址名；
- **服务器端口**：`:8080`表示端口号。
- **文件路径**：`/html/index.html`指的是服务器文件路径，资源的访问位置。
- **查询字符串**：`?userId=1`指的是文件路径中参数。`?`后面以`key=value`的形式。如果后面还需要加参数，用`&`拼接。
- **片段标识符**：`#cn1`指的是文件中的某个位置。相当于一个锚点。
