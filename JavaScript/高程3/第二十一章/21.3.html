<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title></title>
</head>
<body>
  <div id="status"></div>
  <script>
    /**
      ## 进度事件
      有以下6个进度事件：
      * loadstart：在接收响应数据的第一个字节触发。
      * progress：在接收响应期间持续不断地触发。
      * error：在请求发生错误时触发。
      * abort：在因为调用abort()方法而终止连接时触发。
      * load：在接收到完整的响应数据时触发。
      * loadend：在通信完成或触发error、abort或load事件后触发。

      每个请求都从触发loadstart事件开始，接下来是一或多个progress事件，然后触发error、abort或
      load事件中的一个，最后以触发loadend事件结束。这些事件大都很直观，但其中两个事件有一些细节
      需要注意。

      ### load事件
      ```js
      var xhr = new XMLHttpRequest();

      xhr.onload = function() {
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
          console.log(xhr.responseText);
        } else {
          console.log(xhr.status);
        }
      }
      xhr.open("get", "altevents.php", true);
      xhr.send(null);
      ```
      只要浏览器接收到服务器的响应，不管其状态如何，都会触发onload事件。而这意味着必须要检查status属性，
      才能确定数据是否真的已经可用了。

      ### progress事件
      **progress** 这个事件会在浏览器接收新数据期间周期性地触发。而onprogress事件会接收到一个event对象，
      其target属性是XHR对象，但包含着三个额外的属性：**lengthComputable、position和totalSize**。其中，
      **lengthComputable** 是一个表示进度信息是否可用的布尔值，**position** 表示已经接收的字节数，
      **totalSize** 表示根据Content-Length响应头部确定的预期字节数。有了这些信息，可以为用户创建一个进
      度指示器了。来看下面的例子：
      ```js
      var xhr = new XMLHttpRequest();

      xhr.onload = function(event) {
        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
          console.log(xhr.responseText);
        } else {
          console.log(xhr.status);
        }
      };
      xhr.onprogress = function(event) {
        console.log(event);
        var divStatus = document.getElementById("status");
        if (event.lengthComputable) {
          // 这里的每个事件每个浏览器可能存在差异或者是某规范和标准已经把事件的字段修改了
          // 可以自己打印event在控制台查看
          divStatus.innerHTML = "Received" + event.position + "of " +
            event.totalSize + "bytes";
        }
      }
      xhr.open("get", "https://www.easy-mock.com/mock/5dbc5cea9e771148eb1d91ba/example/getData", true);
      xhr.send(null);
      ```
      必须在调用open()方法之前添加onprogress事件。每次触发progress事件，都会以新的状态信息更细HTML
      元素的内容。如果响应头部中包含Content-Length字段，那么也可以利用此信息来计算响应中已接收到的数据的百分比。
    **/
  </script>
</body>
</html>