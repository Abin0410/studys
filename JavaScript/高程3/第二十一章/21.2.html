<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title></title>
  <script>
    /**
      ## XMLHttpRequest2级

      ### FormData
      FormData为序列化表单以及创建与表单格式相同的数据（用于通过XHR传输）提供了便利。来看个例子：
      ```js
      var data = new FormData();
      data.append("name", "xiaoli");
      ```
      这个 **append()** 方法接收两个参数：键和值，分别对应表单字段的名字和字段中包含的值。也可以添加
      任意多个键值对儿。通过向FormData构造函数中传入表单元素，也可以用表单元素的数据预先向其中填入键值
      对儿：
      ```js
      var data = new FormData(document.forms[0]);
      ```
      创建了FormData的实例后，可以将它直接传给XHR的send()方法，如下所示：
      ```js
      var xhr = new XMLHttpRequest();

      xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
          if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
            console.log(xhr.responseText);
          } else {
            console.log(xhr.status);
          }
        }
      };
      var url = "https://www.easy-mock.com/mock/5dbc5cea9e771148eb1d91ba/example/getData"
      xhr.open("post", url, true);

      var form = document.getElementById("user-info");
      xhr.send(new FormData(form));
      ```
      使用FormData的方便之处体现在不必明确地在XHR对象上设置请求头部。XHR对象能够识别传入的数据类型是
      FormData的实例，并配置适当的头部信息。

      ### 超时设定
      XHR对象添加一个timeout属性，表示请求在等待响应多少毫秒之后就终止。在给timeout设置一个数值后，
      如果在规定的时间内浏览器还没有接收到响应，那么就会触发timeout时间，进而会调用ontimeout事件。
      来看下面的例子：
      ```js
      var xhr = new XMLHttpRequest();

      xhr.onreadystatechange = function() {
        if (xhr.readyState == 4) {
          try {
            if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
              console.log(xhr.responseText);
            } else {
              console.log(xhr.status);
            }
          } catch (error) {
            // 假设由ontimeout事件处理
          }
        }
      };
      var url = "https://www.easy-mock.com/mock/5dbc5cea9e771148eb1d91ba/example/getData"
      xhr.open("post", url, true);

      xhr.timeout = 1000; // 将超时设置为1秒钟
      xhr.ontimeout = function() {
        alert("Request did not return in a second.")
      }

      var form = document.getElementById("user-info");
      xhr.send(new FormData(form));
      ```
      ### overrideMimeType()方法
      **overrideMimeType()** 方法，用于重写XHR响应的MIME类型。比如，服务器返回的MIME类型是text/plain，
      但数据中实际包含的是XML。根据MIME类型，即使数据是XML，responseXML属性中仍然是null。通过调用
      **overrideMimeType()**方法，可以保证把响应当作XML而非纯文本来处理。
      ```js
      var xhr = new XMLHttpRequest();
      xhr.open("get", "text.php", true);
      xhr.overrideMimeType("text/xml");
      xhr.send(null);
      ```
      这个例子强迫XHR对象将响应当作XML而非纯文本来处理。调用overrideMimeType()必须在send()方法之前，
      才能保证重写响应的MIME类型。
    **/
  </script>
</head>
<body>
  
</body>
</html>